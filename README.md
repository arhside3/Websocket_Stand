# Веб-интерфейс для осциллографа и мультиметра

Это веб-приложение позволяет управлять осциллографом и мультиметром через удобный веб-интерфейс. Вы можете запускать Lua-сценарии, просматривать текущие измерения в реальном времени, историю показаний и данные из базы данных.

## Особенности

- **Реальное время:** Просмотр данных с осциллографа и мультиметра в реальном времени.
- **Lua-сценарии:** Запуск Lua-сценариев для автоматизации измерений.
- **История:** Просмотр исторических данных за час, день или неделю.
- **База данных:** Просмотр и анализ всех сохраненных измерений.

## Запуск приложения

1. Убедитесь, что у вас установлены все необходимые зависимости:
   ```bash
   pip install -r requirements.txt
   ```

2. Запустите сервер:
   ```bash
   python main.py
   ```

3. Откройте веб-интерфейс в браузере:
   ```
   http://localhost:8080
   ```

## Подключение устройств

Приложение настроено для работы с:
- Осциллографом Rigol DS1074Z
- Мультиметром UT803

### Настройка подключения осциллографа

Осциллограф подключается через USB и использует PyVISA для управления. Адрес VISA осциллографа настроен на:
```
USB0::6833::1230::DS1ZC263402178::0::INSTR
```

### Настройка подключения мультиметра

Мультиметр UT803 подключается через USB HID или RS232 интерфейс. Приложение автоматически определяет тип подключения.

## Работа с веб-интерфейсом

### Вкладка "Текущие данные"

- **Осциллограф:** Отображает текущие формы сигналов. Вы можете включать и выключать отображение каналов с помощью переключателей.
- **Мультиметр:** Показывает текущее значение, режим работы и график изменения показаний.
- **Консоль Lua:** Отображает вывод запущенных Lua-сценариев.

### Вкладка "История"

- Позволяет просматривать историю измерений за различные периоды времени (час, день, неделя).
- Для осциллографа отображается график изменения напряжения.
- Для мультиметра отображается график изменения показаний.

### Вкладка "База данных"

- Отображает все сохраненные измерения в табличном виде.
- Можно переключаться между данными осциллографа и мультиметра.

### Запуск Lua-сценариев

- Нажмите кнопку "Запустить Lua-сценарий" в верхней части интерфейса.
- По умолчанию запускается `main.lua`, который содержит предварительно настроенный тестовый сценарий.

## Структура проекта

- `main.py` - Основной серверный скрипт (WebSocket + HTTP)
- `index.html` - Веб-интерфейс
- `app.js` - JavaScript для работы с интерфейсом
- `main.lua` - Основной Lua-сценарий для автоматизации
- `test_rigol_linux.py` - Скрипт для работы с осциллографом Rigol
- `ut803_linux.py` - Скрипт для работы с мультиметром UT803

## Расширение функциональности

### Создание собственных Lua-сценариев

Вы можете создавать собственные Lua-сценарии для автоматизации измерений. Пример базового сценария:

```lua
local os = require("os")

-- Запуск теста осциллографа
local function run_oscilloscope_test()
    os.execute("python3 test_rigol_linux.py --channel 1")
end

-- Запуск теста мультиметра
local function run_multimeter_test()
    os.execute("python3 ut803_linux.py --measurement_time 10")
end

-- Запуск тестового сценария
print("Запуск теста осциллографа...")
run_oscilloscope_test()
os.execute("sleep 2")

print("Запуск теста мультиметра...")
run_multimeter_test()
```

## Устранение неполадок

### Осциллограф не подключается

- Убедитесь, что осциллограф включен и подключен к компьютеру.
- Проверьте, что правильно указан VISA-адрес в `test_rigol_linux.py`.
- Убедитесь, что установлены все необходимые драйверы для осциллографа.

### Мультиметр не подключается

- Убедитесь, что мультиметр включен и подключен к компьютеру.
- Проверьте наличие прав доступа к USB или COM-порту.
- Для Linux может потребоваться добавить правила udev для доступа к устройству.

### Проблемы с веб-интерфейсом

- Убедитесь, что сервер запущен и работает на правильном порту.
- Проверьте консоль браузера на наличие ошибок JavaScript.
- Убедитесь, что порты 8080 (HTTP) и 8765 (WebSocket) не заняты другими приложениями. 